(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80658,e=>{"use strict";var t=e.i(48277),r=e.i(99738);function s({children:e,className:s,variant:i="primary",size:o="md",isLoading:a=!1,loadingText:l,disabled:d,...c}){return(0,t.jsx)("button",{type:c.type||"button",className:(0,r.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-ring disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",{primary:"bg-primary text-primary-foreground hover:opacity-90 focus-visible:ring-primary",secondary:"bg-secondary text-secondary-foreground hover:opacity-90 focus-visible:ring-secondary",outline:"border border-border hover:bg-accent hover:text-accent-foreground focus-visible:ring-border",ghost:"hover:bg-accent hover:text-accent-foreground focus-visible:ring-accent",danger:"bg-destructive text-destructive-foreground hover:opacity-90 focus-visible:ring-destructive"}[i],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[o],s),disabled:d||a,"aria-live":a?"polite":void 0,"aria-busy":a,...c,children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",role:"img",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:l||"Loading..."})]}):e})}e.s(["default",()=>s])},33189,e=>{"use strict";let t=(0,e.i(35884).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],33189)},50042,e=>{"use strict";var t=e.i(48277),r=e.i(30668),s=e.i(99738);function i({label:e,error:i,helperText:o,className:a,id:l,...d}){let c=r.default.useId(),n=l||c,u=i?`${n}-error`:void 0,m=o?`${n}-helper`:void 0,p=[u,m].filter(Boolean).join(" ")||void 0;return(0,t.jsxs)("div",{className:"w-full",children:[e&&(0,t.jsxs)("label",{htmlFor:n,className:"block text-sm font-medium mb-1.5 text-foreground",children:[e,d.required&&(0,t.jsx)("span",{className:"text-destructive ml-1","aria-label":"required",children:"*"})]}),(0,t.jsx)("input",{id:n,"aria-invalid":i?"true":"false","aria-describedby":p,"aria-required":d.required?"true":void 0,className:(0,s.cn)("w-full px-4 py-2.5 rounded-lg border border-input bg-background text-foreground","placeholder:text-muted-foreground","focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent focus-visible:ring-2 focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",i&&"border-destructive focus:ring-destructive focus-visible:ring-destructive",a),...d}),i&&(0,t.jsx)("p",{id:u,className:"mt-1 text-sm text-destructive",role:"alert","aria-live":"assertive",children:i}),o&&!i&&(0,t.jsx)("p",{id:m,className:"mt-1 text-sm text-muted-foreground",children:o})]})}e.s(["default",()=>i])},768,e=>{"use strict";let t=(0,e.i(35884).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],768)},64609,e=>{"use strict";var t=e.i(48277),r=e.i(30668),s=e.i(96086),i=e.i(33189),o=e.i(768),a=e.i(87635),l=e.i(16506),d=e.i(42588),c=e.i(46471),n=e.i(42854),u=e.i(40206),m=e.i(91482),p=e.i(64076),g=e.i(372),x=e.i(45932),h=e.i(80658),f=e.i(50042);e.i(92544);var b=e.i(11897);let v=x.productSchema.pick({title:!0,description:!0,price:!0,category:!0,condition:!0,location:!0,isNegotiable:!0});function y(){let e=(0,s.useRouter)(),{user:x}=(0,u.useAuth)(),[y,j]=(0,r.useState)([]),[N,w]=(0,r.useState)(!1),[k,C]=(0,r.useState)([]),{register:P,handleSubmit:F,formState:{errors:A,isSubmitting:S},setError:q,setValue:z,watch:B}=(0,c.useForm)({resolver:(0,n.zodResolver)(v),mode:"onBlur",defaultValues:{condition:"good",location:x?.location||"",isNegotiable:!1}}),M=B("isNegotiable");B("condition"),(0,r.useEffect)(()=>{(async()=>{try{let e=await p.categoriesAPI.getCategories();j(e.data.categories)}catch(e){console.error("Failed to fetch categories:",e),b.toast.error("Failed to load categories.")}})()},[]);let I=async e=>{let t=e.target.files;if(t&&0!==t.length){if(k.length+t.length>5)return void b.toast.error("You can only upload up to 5 images");w(!0);try{let e=await g.uploadAPI.uploadImages(Array.from(t));if(e.data.success){let t=e.data.data.map(e=>e.url);C([...k,...t])}}catch(e){console.error("Failed to upload images:",e),b.toast.error("Failed to upload images."),q("root",{type:"manual",message:e.response?.data?.message||"Failed to upload images"})}finally{w(!1)}}},L=async t=>{if(0===k.length)return void q("root",{type:"manual",message:"At least one image is required"});if(k.length>5)return void q("root",{type:"manual",message:"Maximum 5 images allowed"});try{let r=new FormData;r.append("title",t.title),r.append("description",t.description),r.append("price",t.price),r.append("category",t.category),r.append("condition",t.condition),r.append("location",t.location),r.append("isNegotiable",t.isNegotiable.toString()),k.forEach(e=>{r.append("images",e)}),await m.productsAPI.createProduct(r),b.toast.success("Product created successfully!"),e.push("/seller")}catch(e){console.error("Failed to create product:",e),b.toast.error("Failed to create product."),q("root",{type:"manual",message:e.response?.data?.message||"Failed to create product"})}};return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-3xl",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)(l.default,{href:"/seller",className:"inline-flex items-center space-x-2 text-muted-foreground hover:text-foreground mb-4",children:[(0,t.jsx)(i.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back to Dashboard"})]}),(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Add New Product"})]}),A.root&&(0,t.jsx)("div",{className:"mb-4 p-3 rounded-lg bg-destructive/10 text-destructive text-sm",children:A.root.message}),(0,t.jsxs)("form",{onSubmit:F(L),className:"space-y-6",noValidate:!0,children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium mb-3",children:["Product Images ",0===k.length&&(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-8 text-center ${0===k.length?"border-destructive/50":""}`,children:[(0,t.jsx)("input",{type:"file",id:"images",multiple:!0,accept:"image/*",onChange:I,className:"hidden",disabled:N||k.length>=5}),(0,t.jsxs)("label",{htmlFor:"images",className:"cursor-pointer",children:[(0,t.jsx)(o.Upload,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:N?"Uploading...":"Click to upload images (max 5)"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG up to 5MB each"})]})]}),k.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-5 gap-4 mt-4",children:k.map((e,r)=>(0,t.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden border",children:[(0,t.jsx)(d.default,{src:e,alt:`Upload ${r+1}`,fill:!0,className:"object-cover",sizes:"100px"}),(0,t.jsx)("button",{type:"button",onClick:()=>{C(k.filter((e,t)=>t!==r))},className:"absolute top-1 right-1 p-1 bg-destructive text-destructive-foreground rounded-full opacity-0 hover:opacity-100 transition-opacity",children:(0,t.jsx)(a.X,{className:"h-4 w-4"})})]},r))}),0===k.length&&(0,t.jsx)("p",{className:"mt-1 text-sm text-destructive",children:"At least one image is required"})]}),(0,t.jsx)(f.default,{label:"Title",type:"text",placeholder:"e.g., iPhone 13 Pro - Excellent Condition",error:A.title?.message,...P("title")}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description"}),(0,t.jsx)("textarea",{...P("description"),placeholder:"Describe your product in detail...",rows:5,className:`w-full px-4 py-3 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-ring resize-none ${A.description?"border-destructive focus:ring-destructive":"border-input"}`}),A.description&&(0,t.jsx)("p",{className:"mt-1 text-sm text-destructive",children:A.description.message})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)(f.default,{label:"Price (KES)",type:"number",placeholder:"5000",error:A.price?.message,...P("price")})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Category"}),(0,t.jsxs)("select",{...P("category"),className:`w-full px-4 py-3 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-ring ${A.category?"border-destructive focus:ring-destructive":"border-input"}`,children:[(0,t.jsx)("option",{value:"",children:"Select a category"}),y.map(e=>(0,t.jsx)("option",{value:e._id,children:e.name},e._id))]}),A.category&&(0,t.jsx)("p",{className:"mt-1 text-sm text-destructive",children:A.category.message})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Condition"}),(0,t.jsxs)("select",{...P("condition"),className:"w-full px-4 py-3 rounded-lg border border-input bg-background focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,t.jsx)("option",{value:"new",children:"New"}),(0,t.jsx)("option",{value:"like-new",children:"Like New"}),(0,t.jsx)("option",{value:"good",children:"Good"}),(0,t.jsx)("option",{value:"fair",children:"Fair"})]}),A.condition&&(0,t.jsx)("p",{className:"mt-1 text-sm text-destructive",children:A.condition.message})]}),(0,t.jsx)(f.default,{label:"Location",type:"text",placeholder:"e.g., Main Campus, Hostel A",error:A.location?.message,...P("location")})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"negotiable",...P("isNegotiable"),checked:M,onChange:e=>z("isNegotiable",e.target.checked),className:"w-4 h-4 rounded border-input"}),(0,t.jsx)("label",{htmlFor:"negotiable",className:"text-sm font-medium",children:"Price is negotiable"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 pt-4",children:[(0,t.jsx)(h.default,{type:"submit",size:"lg",isLoading:S,children:"Create Product"}),(0,t.jsx)(l.default,{href:"/seller",children:(0,t.jsx)(h.default,{type:"button",variant:"outline",size:"lg",children:"Cancel"})})]})]})]})}e.s(["default",()=>y])}]);