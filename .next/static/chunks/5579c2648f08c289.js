(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80658,e=>{"use strict";var t=e.i(48277),a=e.i(99738);function s({children:e,className:s,variant:i="primary",size:r="md",isLoading:l=!1,loadingText:n,disabled:o,...c}){return(0,t.jsx)("button",{type:c.type||"button",className:(0,a.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-ring disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",{primary:"bg-primary text-primary-foreground hover:opacity-90 focus-visible:ring-primary",secondary:"bg-secondary text-secondary-foreground hover:opacity-90 focus-visible:ring-secondary",outline:"border border-border hover:bg-accent hover:text-accent-foreground focus-visible:ring-border",ghost:"hover:bg-accent hover:text-accent-foreground focus-visible:ring-accent",danger:"bg-destructive text-destructive-foreground hover:opacity-90 focus-visible:ring-destructive"}[i],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[r],s),disabled:o||l,"aria-live":l?"polite":void 0,"aria-busy":l,...c,children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",role:"img",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:n||"Loading..."})]}):e})}e.s(["default",()=>s])},59484,e=>{"use strict";let t=(0,e.i(35884).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>t],59484)},35169,e=>{"use strict";let t=(0,e.i(35884).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],35169)},3893,e=>{"use strict";let t=(0,e.i(35884).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);e.s(["MessageCircle",()=>t],3893)},28901,e=>{"use strict";let t=(0,e.i(35884).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],28901)},94539,e=>{"use strict";var t=e.i(48277),a=e.i(30668),s=e.i(96086),i=e.i(16506),r=e.i(94576),l=e.i(49449),n=e.i(47022),o=e.i(42414),c=e.i(59484),d=e.i(3893),m=e.i(35169),u=e.i(28901),x=e.i(38304),h=e.i(82173),f=e.i(40206),p=e.i(99738),g=e.i(80658);e.i(92544);var y=e.i(11897);function v(){let e=(0,s.useRouter)(),{user:v,isAuthenticated:j}=(0,f.useAuth)(),{socket:b,isConnected:N}=(0,h.useSocket)(),[w,k]=(0,a.useState)([]),[C,A]=(0,a.useState)(0),[R,S]=(0,a.useState)(!0),[P,M]=(0,a.useState)("all"),[F,T]=(0,a.useState)(1),[z,B]=(0,a.useState)(1);(0,a.useEffect)(()=>{j?I():e.push("/login")},[j,P,F]),(0,a.useEffect)(()=>{if(b&&N)return b.on("notification:new",({notification:e,unreadCount:t})=>{A(t),k(t=>[e,...t])}),b.on("notification:unread-count",({count:e})=>{A(e)}),()=>{b.off("notification:new"),b.off("notification:unread-count")}},[b,N]);let I=async()=>{S(!0);try{let e=await x.notificationsAPI.getNotifications({page:F,limit:20,unreadOnly:"unread"===P});k(e.data.data),A(e.data.unreadCount),B(e.data.pagination.pages)}catch(e){console.error("Failed to fetch notifications:",e),y.toast.error("Failed to load notifications.")}finally{S(!1)}},_=async e=>{try{await x.notificationsAPI.markAsRead(e),k(t=>t.map(t=>t._id===e?{...t,isRead:!0,readAt:new Date().toISOString()}:t)),A(e=>Math.max(0,e-1))}catch(e){console.error("Failed to mark as read:",e),y.toast.error("Failed to mark notification as read.")}},$=async()=>{try{await x.notificationsAPI.markAllAsRead(),k(e=>e.map(e=>({...e,isRead:!0,readAt:new Date().toISOString()}))),A(0)}catch(e){console.error("Failed to mark all as read:",e),y.toast.error("Failed to mark all as read.")}},D=async e=>{try{await x.notificationsAPI.deleteNotification(e),k(t=>{let a=t.find(t=>t._id===e),s=a&&!a.isRead?C-1:C;return A(Math.max(0,s)),t.filter(t=>t._id!==e)})}catch(e){console.error("Failed to delete notification:",e),y.toast.error("Failed to delete notification.")}},O=async()=>{if(confirm("Are you sure you want to clear all notifications?"))try{await x.notificationsAPI.clearAll(),k([]),A(0)}catch(e){console.error("Failed to clear notifications:",e),y.toast.error("Failed to clear notifications.")}},L=async t=>{t.isRead||await _(t._id),t.data?.link&&e.push(t.data.link)};return j?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(r.Bell,{className:"h-8 w-8 text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Notifications"}),C>0&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[C," unread"]})]})]}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsxs)(g.default,{variant:"outline",size:"sm",onClick:I,disabled:R,children:[(0,t.jsx)(o.RefreshCw,{className:`h-4 w-4 mr-2 ${R?"animate-spin":""}`}),"Refresh"]})})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{M("all"),T(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"all"===P?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:"All"}),(0,t.jsxs)("button",{onClick:()=>{M("unread"),T(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"unread"===P?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:["Unread ",C>0&&`(${C})`]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[C>0&&(0,t.jsxs)(g.default,{variant:"outline",size:"sm",onClick:$,children:[(0,t.jsx)(n.CheckCheck,{className:"h-4 w-4 mr-2"}),"Mark all read"]}),w.length>0&&(0,t.jsxs)(g.default,{variant:"outline",size:"sm",onClick:O,className:"text-destructive hover:text-destructive",children:[(0,t.jsx)(l.Trash2,{className:"h-4 w-4 mr-2"}),"Clear all"]})]})]}),R?(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)(o.RefreshCw,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading notifications..."})]}):0===w.length?(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)(r.Bell,{className:"h-24 w-24 mx-auto text-muted-foreground mb-4"}),(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:"No notifications"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-6",children:"unread"===P?"No unread notifications":"You're all caught up!"}),(0,t.jsx)(i.default,{href:"/products",children:(0,t.jsx)(g.default,{children:"Browse Products"})})]}):(0,t.jsx)("div",{className:"space-y-2",children:w.map(e=>(0,t.jsx)("div",{onClick:()=>L(e),className:`relative p-4 rounded-lg border bg-card hover:bg-accent cursor-pointer transition-colors ${!e.isRead?"border-primary/50 bg-primary/5":""}`,children:(0,t.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-1",children:(e=>{switch(e){case"order":return(0,t.jsx)(c.Package,{className:"h-5 w-5 text-blue-500"});case"message":return(0,t.jsx)(d.MessageCircle,{className:"h-5 w-5 text-green-500"});case"product":return(0,t.jsx)(c.Package,{className:"h-5 w-5 text-purple-500"});case"review":return(0,t.jsx)(m.Star,{className:"h-5 w-5 text-yellow-500"});case"payout":return(0,t.jsx)(u.DollarSign,{className:"h-5 w-5 text-emerald-500"});default:return(0,t.jsx)(r.Bell,{className:"h-5 w-5 text-muted-foreground"})}})(e.type)}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:`font-semibold mb-1 ${!e.isRead?"text-primary":""}`,children:e.title}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.message}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:(0,p.formatRelativeTime)(e.createdAt)}),e.isRead&&e.readAt&&(0,t.jsxs)("span",{children:["â€¢ Read ",(0,p.formatRelativeTime)(e.readAt)]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[!e.isRead&&(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),_(e._id)},className:"p-2 hover:bg-primary/10 rounded-lg transition-colors",title:"Mark as read",children:(0,t.jsx)(n.CheckCheck,{className:"h-4 w-4 text-primary"})}),(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),D(e._id)},className:"p-2 hover:bg-destructive/10 rounded-lg transition-colors",title:"Delete",children:(0,t.jsx)(l.Trash2,{className:"h-4 w-4 text-destructive"})})]})]})})]})},e._id))}),z>1&&(0,t.jsxs)("div",{className:"flex justify-center mt-8 space-x-2",children:[(0,t.jsx)(g.default,{variant:"outline",onClick:()=>T(e=>Math.max(1,e-1)),disabled:1===F,children:"Previous"}),(0,t.jsxs)("span",{className:"px-4 py-2 text-sm text-muted-foreground",children:["Page ",F," of ",z]}),(0,t.jsx)(g.default,{variant:"outline",onClick:()=>T(e=>Math.min(z,e+1)),disabled:F===z,children:"Next"})]})]})}):null}e.s(["default",()=>v])}]);