(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80658,e=>{"use strict";var s=e.i(48277),r=e.i(99738);function t({children:e,className:t,variant:a="primary",size:o="md",isLoading:n=!1,loadingText:d,disabled:c,...i}){return(0,s.jsx)("button",{type:i.type||"button",className:(0,r.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-ring disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",{primary:"bg-primary text-primary-foreground hover:opacity-90 focus-visible:ring-primary",secondary:"bg-secondary text-secondary-foreground hover:opacity-90 focus-visible:ring-secondary",outline:"border border-border hover:bg-accent hover:text-accent-foreground focus-visible:ring-border",ghost:"hover:bg-accent hover:text-accent-foreground focus-visible:ring-accent",danger:"bg-destructive text-destructive-foreground hover:opacity-90 focus-visible:ring-destructive"}[a],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[o],t),disabled:c||n,"aria-live":n?"polite":void 0,"aria-busy":n,...i,children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",role:"img",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{children:d||"Loading..."})]}):e})}e.s(["default",()=>t])},63753,e=>{"use strict";let s=(0,e.i(35884).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],63753)},40380,e=>{"use strict";let s=(0,e.i(35884).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>s],40380)},19347,e=>{"use strict";var s=e.i(48277),r=e.i(30668),t=e.i(96086),a=e.i(40380),o=e.i(63753);let n=(0,e.i(35884).default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var d=e.i(93561),c=e.i(46471),i=e.i(42854),l=e.i(40206);e.i(92544);var u=e.i(11897),m=e.i(10850),x=e.i(45932),h=e.i(90851),g=e.i(80658);function p(){let e=(0,t.useRouter)(),{user:p,logout:f,forcePasswordChange:b}=(0,l.useAuth)(),[w,y]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),[N,k]=(0,r.useState)(!1),[P,C]=(0,r.useState)(!1),{register:A,handleSubmit:z,watch:E,formState:{errors:S,isSubmitting:$},setError:M}=(0,c.useForm)({resolver:(0,i.zodResolver)(x.passwordChangeSchema),mode:"onBlur"}),O=E("newPassword"),L=E("confirmPassword");E("currentPassword");let R=(0,h.getPasswordStrength)(O||"");(0,r.useEffect)(()=>{p||b||e.push("/login")},[p,b,e]);let T=async s=>{if(s.currentPassword===s.newPassword)return void M("newPassword",{type:"manual",message:"New password must be different from current password"});try{await m.authAPI.changePassword({currentPassword:s.currentPassword,newPassword:s.newPassword}),C(!0),u.toast.success("Password changed successfully!"),setTimeout(()=>{f(),e.push("/login?passwordChanged=true")},2e3)}catch(s){let e=s.response?.data?.message||"Failed to change password";M("root",{type:"manual",message:e}),u.toast.error(e)}};return P?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background px-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,s.jsx)("div",{className:"mb-6 flex justify-center",children:(0,s.jsx)("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:(0,s.jsx)(d.CheckCircle,{className:"w-12 h-12 text-green-600 dark:text-green-400"})})}),(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Password Changed!"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"Your password has been successfully updated. You will be redirected to login shortly."}),(0,s.jsx)(g.default,{onClick:()=>{f(),e.push("/login?passwordChanged=true")},className:"w-full",children:"Continue to Login"})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background px-4 py-12",children:(0,s.jsxs)("div",{className:"max-w-md w-full",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"mb-4 flex justify-center",children:(0,s.jsx)("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center",children:(0,s.jsx)(a.Lock,{className:"w-8 h-8 text-primary"})})}),(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Change Your Password"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:b?"You must change your password before continuing. Please enter your current password and choose a new one.":"Enter your current password and choose a new one."})]}),(0,s.jsx)("div",{className:"bg-card border rounded-lg p-6 shadow-sm",children:(0,s.jsxs)("form",{onSubmit:z(T),className:"space-y-4",noValidate:!0,children:[S.root&&(0,s.jsx)("div",{className:"p-3 rounded-lg bg-destructive/10 border border-destructive/20 text-destructive text-sm",children:S.root.message}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Current Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{...A("currentPassword"),type:w?"text":"password",className:`w-full px-4 py-3 pr-12 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-ring ${S.currentPassword?"border-destructive focus:ring-destructive":"border-input"}`,placeholder:"Enter current password"}),(0,s.jsx)("button",{type:"button",onClick:()=>y(!w),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:w?(0,s.jsx)(n,{className:"h-5 w-5"}):(0,s.jsx)(o.Eye,{className:"h-5 w-5"})})]}),S.currentPassword&&(0,s.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.currentPassword.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{...A("newPassword"),type:j?"text":"password",className:`w-full px-4 py-3 pr-12 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-ring ${S.newPassword?"border-destructive focus:ring-destructive":"border-input"}`,placeholder:"Enter new password (min 12 characters)"}),(0,s.jsx)("button",{type:"button",onClick:()=>v(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:j?(0,s.jsx)(n,{className:"h-5 w-5"}):(0,s.jsx)(o.Eye,{className:"h-5 w-5"})})]}),S.newPassword&&(0,s.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.newPassword.message}),O&&(0,s.jsxs)("div",{className:"mt-2 p-3 rounded-lg bg-muted/50 space-y-2",children:[(0,s.jsx)("p",{className:"text-xs font-medium mb-2",children:"Password Requirements:"}),(0,s.jsxs)("ul",{className:"space-y-1 text-xs",children:[(0,s.jsxs)("li",{className:O?.length>=12?"text-green-600 dark:text-green-400":"text-muted-foreground",children:[O?.length>=12?"✓":"○"," At least 12 characters"]}),(0,s.jsxs)("li",{className:/[a-z]/.test(O||"")?"text-green-600 dark:text-green-400":"text-muted-foreground",children:[/[a-z]/.test(O||"")?"✓":"○"," One lowercase letter (a-z)"]}),(0,s.jsxs)("li",{className:/[A-Z]/.test(O||"")?"text-green-600 dark:text-green-400":"text-muted-foreground",children:[/[A-Z]/.test(O||"")?"✓":"○"," One uppercase letter (A-Z)"]}),(0,s.jsxs)("li",{className:/[0-9]/.test(O||"")?"text-green-600 dark:text-green-400":"text-muted-foreground",children:[/[0-9]/.test(O||"")?"✓":"○"," One number (0-9)"]}),(0,s.jsxs)("li",{className:/[@$!%*?&]/.test(O||"")?"text-green-600 dark:text-green-400":"text-muted-foreground",children:[/[@$!%*?&]/.test(O||"")?"✓":"○"," One special character (@$!%*?&)"]})]}),(0,s.jsx)("div",{className:"flex gap-1 mt-2",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${e<=R.score?R.color:"bg-gray-200 dark:bg-gray-700"}`},e))}),R.label&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Password strength: ",(0,s.jsx)("span",{className:`font-medium ${R.score<=1?"text-red-500":2===R.score?"text-orange-500":3===R.score?"text-yellow-600":"text-green-600"}`,children:R.label})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{...A("confirmPassword"),type:N?"text":"password",className:`w-full px-4 py-3 pr-12 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-ring ${S.confirmPassword?"border-destructive focus:ring-destructive":"border-input"}`,placeholder:"Confirm new password"}),(0,s.jsx)("button",{type:"button",onClick:()=>k(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:N?(0,s.jsx)(n,{className:"h-5 w-5"}):(0,s.jsx)(o.Eye,{className:"h-5 w-5"})})]}),S.confirmPassword&&(0,s.jsx)("p",{className:"mt-1 text-sm text-destructive",children:S.confirmPassword.message}),L&&O&&(0,s.jsx)("div",{className:`text-xs mt-1 ${O===L?"text-green-600 dark:text-green-400":"text-destructive"}`,children:O===L?"✓ Passwords match":"✗ Passwords do not match"})]}),(0,s.jsx)(g.default,{type:"submit",size:"lg",className:"w-full",isLoading:$,children:"Change Password"})]})}),b&&(0,s.jsx)("div",{className:"mt-6 p-4 rounded-lg bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800",children:(0,s.jsxs)("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:[(0,s.jsx)("strong",{children:"Important:"})," You cannot access other features until you change your password."]})}),!b&&(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsx)("button",{type:"button",onClick:()=>e.back(),className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"← Go back"})}),(0,s.jsxs)("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:[(0,s.jsx)("p",{className:"font-medium mb-2",children:"Having trouble?"}),(0,s.jsxs)("p",{children:["WhatsApp: ",(0,s.jsx)("a",{href:"https://wa.me/254111938368",className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",children:"0111938368"})]}),(0,s.jsxs)("p",{children:["Email: ",(0,s.jsx)("a",{href:"mailto:gedionmutua2024@gmail.com",className:"text-primary hover:underline",children:"gedionmutua2024@gmail.com"})]})]})]})})}e.s(["default",()=>p],19347)}]);