module.exports=[99651,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(59843),e=a.i(46710),f=a.i(21900),g=a.i(1073),h=a.i(37637),i=a.i(71907),j=a.i(89698),k=a.i(63062),l=a.i(40360),m=a.i(73092),n=a.i(46350),o=a.i(45634),p=a.i(74155),q=a.i(47802),r=a.i(31261);let s=(0,r.default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),t=(0,r.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var u=a.i(35971),v=a.i(69168),w=a.i(94674),x=a.i(92522),y=a.i(52485),z=a.i(47940);a.i(59888);var A=a.i(98534);function B(){return(0,b.jsx)(z.ClientErrorBoundary,{children:(0,b.jsx)(C,{})})}function C(){let{user:a,isAdmin:r}=(0,u.useAuth)(),[z,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)("all"),[I,J]=(0,c.useState)(1),[K,L]=(0,c.useState)(1),[M,N]=(0,c.useState)(0),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(null),[U,V]=(0,c.useState)(null),[W,X]=(0,c.useState)(""),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)(""),[ac,ad]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!r){T({type:"error",text:"Access denied. Admin only."}),D(!1);return}ae()},[r,I,G]);let ae=(0,c.useCallback)(async()=>{if(r)try{D(!0);let b={page:I,limit:20};"all"!==G&&(b.role=G);let c=(await v.usersAPI.getUsers(b)).data,d=c.users;if(d=d.filter(b=>b._id!==a?._id),E){let a=E.toLowerCase();d=d.filter(b=>b.name.toLowerCase().includes(a)||b.email.toLowerCase().includes(a)||b.phone.includes(a))}B(d),L(c.pagination.pages),N(c.pagination.total)}catch(a){console.error("Failed to fetch users:",a),A.toast.error("Failed to load users. Please try again."),T({type:"error",text:"Failed to load users. Please try again."})}finally{D(!1)}},[r,I,G,E,a?._id]);(0,c.useEffect)(()=>{if(void 0!==E){let a=setTimeout(()=>{1===I?ae():J(1)},500);return()=>clearTimeout(a)}},[E,I,ae]);let af=async(a,b)=>{try{P(a),await v.usersAPI.updateUser(a,{role:b}),B(z.map(c=>c._id===a?{...c,role:b}:c)),T({type:"success",text:"User role updated successfully"}),V(null),X("")}catch(a){console.error("Failed to update role:",a),A.toast.error("Failed to update user role. Please try again."),T({type:"error",text:"Failed to update user role. Please try again."})}finally{P(null)}},ag=async a=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{R(a),await v.usersAPI.deleteUser(a),B(z.filter(b=>b._id!==a)),N(a=>a-1),T({type:"success",text:"User deleted successfully"})}catch(a){console.error("Failed to delete user:",a),A.toast.error("Failed to delete user. Please try again."),T({type:"error",text:"Failed to delete user. Please try again."})}finally{R(null)}},ah=()=>{V(null),X("")},ai=async a=>{try{ad(!0);let b=await v.usersAPI.resetUserPassword(a._id);ab(b.data.data.newPassword),_(a),Z(!0)}catch(a){T({type:"error",text:a.response?.data?.message||"Failed to reset password"})}finally{ad(!1)}};return r?C?(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsx)(y.PageHeaderSkeleton,{showSubtitle:!0,showActions:!1}),(0,b.jsx)(y.StatsCardsSkeleton,{count:4}),(0,b.jsxs)("div",{className:"mt-8 bg-card rounded-lg border",children:[(0,b.jsx)("div",{className:"px-6 py-3 border-b",children:(0,b.jsx)("div",{className:"h-5 bg-muted rounded w-20 animate-pulse"})}),(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)(y.TableSkeleton,{rows:10,columns:7,showAvatar:!0})})]})]}):(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)(d.default,{href:"/admin",className:"inline-flex items-center text-muted-foreground hover:text-foreground mb-4",children:[(0,b.jsx)(f.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"User Management"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage user accounts and permissions"})]}),S&&(0,b.jsx)("div",{className:`mb-6 p-4 rounded-lg ${"success"===S.type?"bg-green-50 text-green-900 dark:bg-green-900/20 dark:text-green-200":"bg-red-50 text-red-900 dark:bg-red-900/20 dark:text-red-200"}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:S.text}),(0,b.jsx)("button",{onClick:()=>T(null),className:"ml-4 hover:opacity-70",children:(0,b.jsx)(q.X,{className:"h-4 w-4"})})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsxs)(w.Card,{children:[(0,b.jsxs)(w.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(w.CardTitle,{className:"text-sm font-medium",children:"Total Users"}),(0,b.jsx)(g.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(w.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:M})})]}),(0,b.jsxs)(w.Card,{children:[(0,b.jsxs)(w.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(w.CardTitle,{className:"text-sm font-medium",children:"Buyers"}),(0,b.jsx)(m.Shield,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(w.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:z.filter(a=>"buyer"===a.role).length})})]}),(0,b.jsxs)(w.Card,{children:[(0,b.jsxs)(w.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(w.CardTitle,{className:"text-sm font-medium",children:"Sellers"}),(0,b.jsx)(m.Shield,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(w.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:z.filter(a=>"seller"===a.role).length})})]}),(0,b.jsxs)(w.Card,{children:[(0,b.jsxs)(w.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(w.CardTitle,{className:"text-sm font-medium",children:"Admins"}),(0,b.jsx)(m.Shield,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(w.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:z.filter(a=>"admin"===a.role).length})})]})]}),(0,b.jsx)(w.Card,{className:"mb-6",children:(0,b.jsx)(w.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(h.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)("input",{type:"text",placeholder:"Search by name, email, or phone...",value:E,onChange:a=>F(a.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,b.jsxs)("select",{value:G,onChange:a=>{H(a.target.value),J(1)},className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,b.jsx)("option",{value:"all",children:"All Roles"}),(0,b.jsx)("option",{value:"buyer",children:"Buyers"}),(0,b.jsx)("option",{value:"seller",children:"Sellers"}),(0,b.jsx)("option",{value:"admin",children:"Admins"})]})]})})}),(0,b.jsxs)(w.Card,{children:[(0,b.jsx)(w.CardHeader,{children:(0,b.jsxs)(w.CardTitle,{children:["Users (",z.length,")"]})}),(0,b.jsx)(w.CardContent,{children:0===z.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(g.Users,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No Users Found"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:E||"all"!==G?"Try adjusting your filters or search terms.":"No users registered yet."})]}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-sm",children:"User"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-sm",children:"Contact"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-sm",children:"Location"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-sm",children:"Role"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-sm",children:"Status"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-sm",children:"Joined"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-medium text-sm",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:z.map(a=>{var c;return(0,b.jsxs)("tr",{className:"border-b hover:bg-muted/50",children:[(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(e.default,{src:a.avatar,alt:a.name,size:"md"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["ID: ",a._id.slice(-6)]})]})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center text-sm",children:[(0,b.jsx)(i.Mail,{className:"h-3 w-3 mr-2 text-muted-foreground"}),(0,b.jsx)("span",{className:"truncate max-w-[200px]",children:a.email})]}),(0,b.jsxs)("div",{className:"flex items-center text-sm",children:[(0,b.jsx)(j.Phone,{className:"h-3 w-3 mr-2 text-muted-foreground"}),(0,b.jsx)("span",{children:a.phone})]})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:a.location?(0,b.jsxs)("div",{className:"flex items-center text-sm",children:[(0,b.jsx)(k.MapPin,{className:"h-3 w-3 mr-1 text-muted-foreground"}),(0,b.jsx)("span",{children:a.location})]}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"N/A"})}),(0,b.jsx)("td",{className:"py-4 px-4",children:U===a._id?(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)("select",{value:W,onChange:a=>X(a.target.value),className:"px-2 py-1 border rounded text-sm focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,b.jsx)("option",{value:"buyer",children:"Buyer"}),(0,b.jsx)("option",{value:"seller",children:"Seller"}),(0,b.jsx)("option",{value:"admin",children:"Admin"})]}),(0,b.jsx)("button",{onClick:()=>af(a._id,W),disabled:O===a._id,className:"text-green-600 hover:text-green-700 disabled:opacity-50",children:(0,b.jsx)(p.Check,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:ah,className:"text-red-600 hover:text-red-700",children:(0,b.jsx)(q.X,{className:"h-4 w-4"})})]}):(0,b.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(a=>{switch(a){case"admin":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";case"seller":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}})(a.role)}`,children:a.role.charAt(0).toUpperCase()+a.role.slice(1)})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"space-y-1",children:[a.isVerified&&(0,b.jsxs)("span",{className:"inline-flex items-center text-xs text-green-600",children:[(0,b.jsx)(p.Check,{className:"h-3 w-3 mr-1"}),"Verified"]}),void 0!==a.isActive&&(0,b.jsx)("div",{className:`text-xs ${a.isActive?"text-green-600":"text-red-600"}`,children:a.isActive?"Active":"Inactive"})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,b.jsx)(l.Calendar,{className:"h-3 w-3 mr-1"}),(c=a.createdAt)?new Date(c).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"N/A"]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,b.jsxs)(x.default,{onClick:()=>{var b,c;return b=a._id,c=a.role,void(V(b),X(c))},disabled:O===a._id||Q===a._id,size:"sm",variant:"outline",children:[(0,b.jsx)(o.Edit,{className:"h-3 w-3 mr-1"}),"Role"]}),(0,b.jsxs)(x.default,{onClick:()=>ai(a),disabled:ac,size:"sm",variant:"outline",className:"text-orange-600 hover:text-orange-700 border-orange-600 hover:bg-orange-50",children:[(0,b.jsx)(s,{className:"h-3 w-3 mr-1"}),"Reset"]}),(0,b.jsx)(x.default,{onClick:()=>ag(a._id),disabled:O===a._id||Q===a._id,size:"sm",variant:"danger",children:Q===a._id?"Deleting...":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Trash2,{className:"h-3 w-3 mr-1"}),"Delete"]})})]})})]},a._id)})})]})})})]}),K>1&&(0,b.jsxs)("div",{className:"flex justify-center items-center space-x-2 mt-6",children:[(0,b.jsx)(x.default,{onClick:()=>J(a=>Math.max(1,a-1)),disabled:1===I,variant:"outline",size:"sm",children:"Previous"}),(0,b.jsxs)("span",{className:"text-sm",children:["Page ",I," of ",K]}),(0,b.jsx)(x.default,{onClick:()=>J(a=>Math.min(K,a+1)),disabled:I===K,variant:"outline",size:"sm",children:"Next"})]}),Y&&$&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-background rounded-lg p-6 max-w-md w-full mx-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Password Reset Successful"}),(0,b.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-green-50 dark:bg-green-950 p-4 rounded-lg border border-green-200 dark:border-green-800",children:[(0,b.jsxs)("p",{className:"text-sm font-medium mb-2",children:["New Password for ",$.name,":"]}),(0,b.jsxs)("div",{className:"flex items-center justify-between bg-white dark:bg-gray-800 px-4 py-3 rounded border",children:[(0,b.jsx)("code",{className:"text-lg font-mono font-bold",children:aa}),(0,b.jsx)(x.default,{onClick:()=>navigator.clipboard.writeText(aa),size:"sm",variant:"ghost",children:(0,b.jsx)(t,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please communicate this password to the user via phone or other secure channel. The user should change it after logging in."})}),(0,b.jsxs)("div",{className:"text-sm space-y-1 p-3 bg-muted rounded",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Email:"})," ",$.email]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Phone:"})," ",$.phone]})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(x.default,{onClick:()=>{Z(!1),_(null),ab("")},children:"Done"})})]})})]}):(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsx)(w.Card,{className:"max-w-md mx-auto",children:(0,b.jsx)(w.CardContent,{className:"py-8",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(m.Shield,{className:"h-12 w-12 mx-auto text-destructive mb-4"}),(0,b.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Access Denied"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"You don't have permission to access this page."})]})})})})}a.s(["default",()=>B],99651)}];

//# sourceMappingURL=frontend_app_admin_users_page_tsx_0c120179._.js.map