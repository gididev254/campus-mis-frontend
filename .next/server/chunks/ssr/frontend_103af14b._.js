module.exports=[26910,a=>{"use strict";let b=(0,a.i(31261).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);a.s(["Package",()=>b],26910)},63062,a=>{"use strict";let b=(0,a.i(31261).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],63062)},25792,a=>{"use strict";let b=(0,a.i(31261).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],25792)},78807,a=>{"use strict";let b=(0,a.i(31261).default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]);a.s(["Clock",()=>b],78807)},89698,a=>{"use strict";let b=(0,a.i(31261).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);a.s(["Phone",()=>b],89698)},71907,a=>{"use strict";let b=(0,a.i(31261).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);a.s(["Mail",()=>b],71907)},53461,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(70579),f=a.i(69355),g=a.i(63062),h=a.i(89698),i=a.i(71907),j=a.i(26910),k=a.i(78807),l=a.i(65718),m=a.i(25792),n=a.i(79373),o=a.i(97763),p=a.i(35971),q=a.i(13916);a.i(59888);var r=a.i(98534),s=a.i(52485);function t(){let a=(0,d.useParams)(),t=(0,d.useRouter)(),{isAuthenticated:u}=(0,p.useAuth)(),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(!1);(0,c.useEffect)(()=>{u?(async()=>{try{let b=await o.ordersAPI.getOrder(a.id);w(b.data.order)}catch(a){console.error("Failed to fetch order:",a),r.toast.error("Failed to load order details."),a.response?.status===404?(r.toast.error("Order not found"),t.push("/buyer/orders")):a.response?.status===403&&(r.toast.error("You are not authorized to view this order"),t.push("/products"))}finally{y(!1)}})():t.push("/login")},[a.id,u,t]);let F=async()=>{if(v&&confirm("Are you sure you want to cancel this order?")){A(!0);try{await o.ordersAPI.cancelOrder(v._id,{reason:"buyer-request"}),r.toast.success("Order cancelled successfully");let a=await o.ordersAPI.getOrder(v._id);w(a.data.order)}catch(a){console.error("Failed to cancel order:",a),r.toast.error("Failed to cancel order."),r.toast.error(a.response?.data?.message||"Failed to cancel order")}finally{A(!1)}}},G=async()=>{if(v){if(!B||B.length<10)return void r.toast.error("Please enter a valid phone number");E(!0);try{let a=await o.ordersAPI.initiatePayment(v._id,{phoneNumber:B});r.toast.success("Payment initiated! Check your phone for M-Pesa prompt.",{description:`Request ID: ${a.data.checkoutRequestID}`});let b=await o.ordersAPI.getOrder(v._id);w(b.data.order)}catch(a){console.error("Failed to initiate payment:",a),r.toast.error("Failed to initiate payment."),r.toast.error(a.response?.data?.message||"Failed to initiate payment")}finally{E(!1)}}};return x?(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsx)(s.OrderDetailSkeleton,{})})}):v?(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Order Details"}),(0,b.jsxs)("p",{className:"text-muted-foreground mt-1",children:["Order #",v.orderNumber]})]}),(0,b.jsx)("button",{onClick:()=>t.back(),className:"px-4 py-2 border rounded-lg hover:bg-accent transition-colors",children:"Back"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)("div",{className:"rounded-lg border bg-card p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Order Status"}),(0,b.jsx)("p",{className:"text-2xl font-bold capitalize mt-1",children:v.status})]}),(()=>{if(!v)return null;switch(v.status){case"pending":return(0,b.jsx)(k.Clock,{className:"h-5 w-5 text-yellow-500"});case"confirmed":return(0,b.jsx)(l.CheckCircle,{className:"h-5 w-5 text-blue-500"});case"shipped":return(0,b.jsx)(j.Package,{className:"h-5 w-5 text-purple-500"});case"delivered":return(0,b.jsx)(l.CheckCircle,{className:"h-5 w-5 text-green-500"});case"cancelled":return(0,b.jsx)(m.XCircle,{className:"h-5 w-5 text-red-500"});case"refunded":return(0,b.jsx)(n.AlertCircle,{className:"h-5 w-5 text-orange-500"});default:return(0,b.jsx)(n.AlertCircle,{className:"h-5 w-5 text-gray-500"})}})()]})}),(0,b.jsx)("div",{className:"rounded-lg border bg-card p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Payment Status"}),(0,b.jsx)("p",{className:`text-2xl font-bold capitalize mt-1 ${(()=>{if(!v)return"text-gray-500";switch(v.paymentStatus){case"completed":return"text-green-500";case"pending":return"text-yellow-500";case"failed":return"text-red-500";case"refunded":return"text-orange-500";default:return"text-gray-500"}})()}`,children:v.paymentStatus})]}),"completed"===v.paymentStatus?(0,b.jsx)(l.CheckCircle,{className:"h-5 w-5 text-green-500"}):(0,b.jsx)(k.Clock,{className:"h-5 w-5 text-yellow-500"})]})})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Product Information"}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("div",{className:"relative w-24 h-24 rounded-lg overflow-hidden bg-muted flex-shrink-0",children:v.product.images?.[0]?(0,b.jsx)(e.default,{src:v.product.images[0],alt:v.product.title,fill:!0,className:"object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"No Image"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold",children:v.product.title}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Seller: ",v.seller.name]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Quantity: ",v.quantity]}),(0,b.jsx)("p",{className:"text-lg font-bold text-primary mt-2",children:(0,q.formatPrice)(v.totalPrice)})]})]})]}),v.shippingAddress&&(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,b.jsx)(g.MapPin,{className:"h-5 w-5 text-primary"}),(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Shipping Address"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[v.shippingAddress.street&&(0,b.jsx)("p",{className:"text-sm",children:v.shippingAddress.street}),(v.shippingAddress.building||v.shippingAddress.room)&&(0,b.jsxs)("p",{className:"text-sm",children:[v.shippingAddress.building&&`Building: ${v.shippingAddress.building}`,v.shippingAddress.building&&v.shippingAddress.room&&", ",v.shippingAddress.room&&`Room: ${v.shippingAddress.room}`]}),v.shippingAddress.city&&(0,b.jsx)("p",{className:"text-sm",children:v.shippingAddress.city}),v.shippingAddress.landmarks&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Landmarks: ",v.shippingAddress.landmarks]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Seller Information"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(i.Mail,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Email"}),(0,b.jsx)("p",{className:"font-medium",children:v.seller.email})]})]}),v.seller.phone&&(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(h.Phone,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Phone"}),(0,b.jsx)("p",{className:"font-medium",children:v.seller.phone})]})]})]})]}),"pending"===v.paymentStatus&&(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Complete Payment"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"M-Pesa Phone Number"}),(0,b.jsx)("input",{type:"tel",placeholder:"e.g., 0712345678",value:B,onChange:a=>C(a.target.value),className:"w-full px-4 py-2 rounded-lg border bg-background"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"You will receive an M-Pesa prompt on this number"})]}),(0,b.jsx)("button",{onClick:G,disabled:D,className:"w-full px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:D?(0,b.jsxs)("span",{className:"flex items-center justify-center space-x-2",children:[(0,b.jsx)(f.Loader2,{className:"h-5 w-5 animate-spin"}),(0,b.jsx)("span",{children:"Processing..."})]}):`Pay ${(0,q.formatPrice)(v.totalPrice)}`})]})]}),"pending"===v.status&&(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Actions"}),(0,b.jsx)("button",{onClick:F,disabled:z,className:"w-full px-6 py-3 bg-destructive text-destructive-foreground rounded-lg hover:bg-destructive/90 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:z?(0,b.jsxs)("span",{className:"flex items-center justify-center space-x-2",children:[(0,b.jsx)(f.Loader2,{className:"h-5 w-5 animate-spin"}),(0,b.jsx)("span",{children:"Cancelling..."})]}):"Cancel Order"})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Timeline"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(k.Clock,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Order Placed"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(v.createdAt).toLocaleString()})]})]}),v.deliveredAt&&(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(l.CheckCircle,{className:"h-5 w-5 text-green-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Delivered"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(v.deliveredAt).toLocaleString()})]})]}),v.cancelledAt&&(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(m.XCircle,{className:"h-5 w-5 text-red-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cancelled"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(v.cancelledAt).toLocaleString()})]})]})]})]}),v.mpesaTransactionId&&(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Payment Details"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Transaction ID"}),(0,b.jsx)("span",{className:"font-medium",children:v.mpesaTransactionId})]}),v.mpesaPhoneNumber&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Phone Number"}),(0,b.jsx)("span",{className:"font-medium",children:v.mpesaPhoneNumber})]})]})]})]})}):null}a.s(["default",()=>t])}];

//# sourceMappingURL=frontend_103af14b._.js.map