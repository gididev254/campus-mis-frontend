module.exports=[63062,a=>{"use strict";let b=(0,a.i(31261).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],63062)},47940,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(32722);class e extends c.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,b){console.error("ClientErrorBoundary caught an error:",a,b)}resetError=()=>{this.setState({hasError:!1,error:null})};render(){if(this.state.hasError){let a=this.props.fallback||d.ErrorFallback;return(0,b.jsx)(a,{error:this.state.error,resetError:this.resetError})}return this.props.children}}a.s(["ClientErrorBoundary",()=>e])},26910,a=>{"use strict";let b=(0,a.i(31261).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);a.s(["Package",()=>b],26910)},73904,a=>{"use strict";var b=a.i(57850),c=a.i(70579),d=a.i(13916),e=a.i(45056),f=a.i(62129);function g({className:a,aspectRatio:c,width:e,height:f}){return(0,b.jsx)("div",{className:(0,d.cn)("animate-pulse bg-muted rounded-lg overflow-hidden",c?({square:"aspect-square",video:"aspect-video",portrait:"aspect-[3/4]",landscape:"aspect-[4/3]"})[c]:"",a),style:{width:e,height:f},"aria-hidden":"true",children:(0,b.jsx)("div",{className:"w-full h-full bg-gradient-to-r from-transparent via-muted-foreground/10 to-transparent animate-[shimmer_1.5s_infinite]"})})}function h({src:a,alt:h,fill:i=!1,width:j,height:k,className:l,priority:m=!1,sizes:n,showFallback:o=!0,fallbackText:p="No Image",showSkeleton:q=!1,blurColor:r=f.BLUR_COLORS.product}){let[s,t]=(0,e.useState)(!0),[u,v]=(0,e.useState)(!1),w=(0,b.jsx)("div",{className:(0,d.cn)("w-full h-full flex items-center justify-center text-muted-foreground text-sm",l),children:p});if(!a||u)return o?w:null;let x=(0,f.generateCloudinaryBlurDataURL)(a)||(0,f.generateColoredBlurDataURL)(r),y={src:a,alt:h,...m&&{priority:m},sizes:n,...i?{fill:!0,className:(0,d.cn)("object-cover transition-opacity duration-500 ease-in-out",s?"opacity-0":"opacity-100",l)}:{width:j,height:k,className:(0,d.cn)("object-cover transition-opacity duration-500 ease-in-out",s?"opacity-0":"opacity-100",l)},onLoad:()=>t(!1),onError:()=>v(!0),placeholder:"blur",blurDataURL:x||f.DEFAULT_BLUR_DATA_URL};return(0,b.jsxs)(b.Fragment,{children:[s&&q&&(0,b.jsx)("div",{className:"absolute inset-0 z-10",children:(0,b.jsx)(g,{className:"w-full h-full"})}),(0,b.jsx)(c.default,{...y})]})}a.s(["default",()=>h],73904)},59996,a=>{"use strict";let b=(0,a.i(31261).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],59996)},83522,a=>{"use strict";let b=(0,a.i(31261).default)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]);a.s(["ShoppingBag",()=>b],83522)},58317,a=>{"use strict";let b=(0,a.i(31261).default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);a.s(["Minus",()=>b],58317)},11810,a=>{"use strict";let b=(0,a.i(31261).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);a.s(["ArrowRight",()=>b],11810)},24476,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(59843),e=a.i(73904),f=a.i(46350),g=a.i(59996),h=a.i(58317),i=a.i(83522),j=a.i(11810),k=a.i(63062),l=a.i(26910),m=a.i(45369),n=a.i(35971),o=a.i(13916),p=a.i(97763),q=a.i(93609),r=a.i(47940);a.i(59888);var s=a.i(98534);function t(){return(0,b.jsx)(r.ClientErrorBoundary,{children:(0,b.jsx)(u,{})})}function u(){let{cart:a,cartCount:r,cartTotal:t,loading:u,removeFromCart:v,updateQuantity:w,clearCart:x}=(0,m.useCart)(),{user:y,isAuthenticated:z}=(0,n.useAuth)(),A=(0,q.useRouter)(),[B,C]=(0,c.useState)({street:"",building:"",room:""}),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1);(0,c.useEffect)(()=>{z||A.push("/login?redirect=/buyer/cart")},[z,A]);let H=(0,c.useCallback)(async a=>{if(confirm("Remove this item from cart?"))try{await v(a),s.toast.success("Item removed from cart")}catch(a){console.error("Failed to remove item:",a),s.toast.error("Failed to remove item from cart."),s.toast.error("Failed to remove item")}},[v]),I=(0,c.useCallback)(async(a,b)=>{try{await w(a,b)}catch(a){console.error("Failed to update quantity:",a),s.toast.error("Failed to update quantity.")}},[w]),J=(0,c.useCallback)(async()=>{if(confirm("Clear all items from cart?"))try{await x(),s.toast.success("Cart cleared successfully")}catch(a){console.error("Failed to clear cart:",a),s.toast.error("Failed to clear cart."),s.toast.error("Failed to clear cart")}},[x]);(0,c.useCallback)(async(a,b)=>{try{let c=await p.ordersAPI.createOrder({productId:a,quantity:1,shippingAddress:b});A.push(`/buyer/orders/${c.data.order._id}`)}catch(a){console.error("Failed to checkout:",a),s.toast.error("Failed to proceed to checkout."),s.toast.error(a.response?.data?.message||"Failed to create order")}},[A]);let K=(0,c.useMemo)(()=>a.reduce((a,b)=>{let c=b.product.seller._id;return a[c]||(a[c]={sellerName:b.product.seller.name,items:[],total:0}),a[c].items.push(b),a[c].total+=b.product.price*b.quantity,a},{}),[a]),{sellerGroups:L,sellerCount:M}=(0,c.useMemo)(()=>{let a=Object.values(K);return{sellerGroups:a,sellerCount:a.length}},[K]);(0,c.useMemo)(()=>new Set(a.map(a=>a.product.seller._id)).size,[a]);let N=(0,c.useCallback)(async()=>{if(0===a.length)return;if(!B.street||!B.building||!B.room){E(!0),s.toast.error("Please fill in your shipping address");return}let b=y?.phone||"";if(!b)return void s.toast.error("Please update your phone number in your profile",{action:{label:"Update Profile",onClick:()=>A.push("/profile")}});try{G(!0);let a=L.map(a=>`- ${a.sellerName}: ${(0,o.formatPrice)(a.total)} (${a.items.length} item(s))`).join("\n");if(!confirm(`You will be charged ${(0,o.formatPrice)(t)} for ${r} item(s) from ${M} seller(s).

Breakdown by seller:
${a}

Proceed with payment?`))return void G(!1);let c=await p.ordersAPI.checkoutCart({shippingAddress:B,phoneNumber:b,paymentMethod:"mpesa"});await x(),s.toast.success(`Checkout successful! ${c.data.orderCount} order(s) created. Please check your phone for M-Pesa prompt.`,{description:`Total: ${(0,o.formatPrice)(c.data.totalAmount)}`}),A.push(`/buyer/orders?session=${c.data.checkoutSessionId}`)}catch(a){console.error("Failed to checkout:",a),s.toast.error("Failed to proceed to checkout."),s.toast.error(a.response?.data?.message||"Checkout failed. Please try again."),s.toast.error(a.response?.data?.message||"Failed to checkout. Please try again.")}finally{G(!1)}},[a,r,t,B,y?.phone,L,M,x,A]);return(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(i.ShoppingBag,{className:"h-8 w-8 text-primary"}),(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Shopping Cart"}),r>0&&(0,b.jsxs)("span",{className:"px-3 py-1 rounded-full bg-primary text-primary-foreground text-sm",children:[r," ",1===r?"item":"items"]})]}),a.length>0&&(0,b.jsx)("button",{onClick:J,className:"text-sm text-destructive hover:underline",children:"Clear Cart"})]}),u?(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)("div",{className:"animate-spin text-4xl",children:"â³"}),(0,b.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Loading cart..."})]}):0===a.length?(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)(i.ShoppingBag,{className:"h-24 w-24 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:"Your cart is empty"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6",children:"Add some items to get started!"}),(0,b.jsxs)(d.default,{href:"/products",className:"inline-flex items-center space-x-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:[(0,b.jsx)("span",{children:"Browse Products"}),(0,b.jsx)(j.ArrowRight,{className:"h-5 w-5"})]})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 p-4 rounded-lg border bg-card",children:[(0,b.jsx)(d.default,{href:`/products/${a.product._id}`,className:"relative w-full sm:w-32 h-32 flex-shrink-0 rounded-lg overflow-hidden bg-muted",children:(0,b.jsx)(e.default,{src:a.product.images?.[0],alt:a.product.title,fill:!0})}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.default,{href:`/products/${a.product._id}`,className:"font-semibold hover:text-primary transition-colors",children:a.product.title}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Seller: ",a.product.seller?.name]})]}),(0,b.jsx)("button",{onClick:()=>H(a.product._id),className:"p-2 text-destructive hover:bg-destructive/10 rounded-lg transition-colors",title:"Remove from cart",children:(0,b.jsx)(f.Trash2,{className:"h-5 w-5"})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"text-lg font-bold text-primary",children:(0,o.formatPrice)(a.product.price)}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("button",{onClick:()=>I(a.product._id,Math.max(1,a.quantity-1)),className:"p-1 rounded border hover:bg-accent transition-colors",disabled:a.quantity<=1,children:(0,b.jsx)(h.Minus,{className:"h-4 w-4"})}),(0,b.jsx)("span",{className:"w-12 text-center font-medium",children:a.quantity}),(0,b.jsx)("button",{onClick:()=>I(a.product._id,a.quantity+1),className:"p-1 rounded border hover:bg-accent transition-colors",children:(0,b.jsx)(g.Plus,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Subtotal:"," ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:(0,o.formatPrice)(a.product.price*a.quantity)})]}),(0,b.jsx)(d.default,{href:`/buyer/checkout?productId=${a.product._id}&quantity=${a.quantity}`,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors text-sm font-medium",children:"Buy Now"})]})]})]},a.product._id))}),D&&(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,b.jsx)(k.MapPin,{className:"h-5 w-5 text-primary"}),(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Shipping Address"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Street/Hall Name *"}),(0,b.jsx)("input",{type:"text",value:B.street,onChange:a=>C({...B,street:a.target.value}),placeholder:"e.g., Main Street, Hostel A",className:"w-full px-4 py-2 rounded-lg border bg-background"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Building/Floor *"}),(0,b.jsx)("input",{type:"text",value:B.building,onChange:a=>C({...B,building:a.target.value}),placeholder:"e.g., Building 1, 2nd Floor",className:"w-full px-4 py-2 rounded-lg border bg-background"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Room Number *"}),(0,b.jsx)("input",{type:"text",value:B.room,onChange:a=>C({...B,room:a.target.value}),placeholder:"e.g., Room 123, 2B",className:"w-full px-4 py-2 rounded-lg border bg-background"})]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-card p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),a.length>0&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-4 p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[(0,b.jsx)(l.Package,{className:"h-5 w-5 text-blue-600"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("p",{className:"text-sm font-medium",children:["Items from ",new Set(a.map(a=>a.product.seller._id)).size," seller(s)"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"You'll receive one M-Pesa prompt for the total amount"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,b.jsx)("span",{className:"font-medium",children:(0,o.formatPrice)(t)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Shipping"}),(0,b.jsx)("span",{className:"font-medium",children:"Calculated at checkout"})]}),(0,b.jsx)("div",{className:"h-px bg-border my-2"}),(0,b.jsxs)("div",{className:"flex justify-between text-lg",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Total"}),(0,b.jsx)("span",{className:"font-bold text-primary",children:(0,o.formatPrice)(t)})]})]}),(0,b.jsx)("button",{onClick:N,disabled:F||0===a.length,className:"w-full mt-6 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:F?"Processing...":"Proceed to Checkout"}),(0,b.jsx)(d.default,{href:"/products",className:"block w-full mt-3 text-center text-sm text-muted-foreground hover:text-primary transition-colors",children:"Continue Shopping"})]})]})]})})}a.s(["default",()=>t])}];

//# sourceMappingURL=frontend_132a9686._.js.map