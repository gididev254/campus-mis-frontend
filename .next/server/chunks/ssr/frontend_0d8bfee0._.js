module.exports=[92522,a=>{"use strict";var b=a.i(57850),c=a.i(13916);function d({children:a,className:d,variant:e="primary",size:f="md",isLoading:g=!1,loadingText:h,disabled:i,...j}){return(0,b.jsx)("button",{type:j.type||"button",className:(0,c.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-ring disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed",{primary:"bg-primary text-primary-foreground hover:opacity-90 focus-visible:ring-primary",secondary:"bg-secondary text-secondary-foreground hover:opacity-90 focus-visible:ring-secondary",outline:"border border-border hover:bg-accent hover:text-accent-foreground focus-visible:ring-border",ghost:"hover:bg-accent hover:text-accent-foreground focus-visible:ring-accent",danger:"bg-destructive text-destructive-foreground hover:opacity-90 focus-visible:ring-destructive"}[e],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[f],d),disabled:i||g,"aria-live":g?"polite":void 0,"aria-busy":g,...j,children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",role:"img",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,b.jsx)("span",{children:h||"Loading..."})]}):a})}a.s(["default",()=>d])},21900,a=>{"use strict";let b=(0,a.i(31261).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],21900)},18188,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(13916);function e({label:a,error:e,helperText:f,className:g,id:h,...i}){let j=c.default.useId(),k=h||j,l=e?`${k}-error`:void 0,m=f?`${k}-helper`:void 0,n=[l,m].filter(Boolean).join(" ")||void 0;return(0,b.jsxs)("div",{className:"w-full",children:[a&&(0,b.jsxs)("label",{htmlFor:k,className:"block text-sm font-medium mb-1.5 text-foreground",children:[a,i.required&&(0,b.jsx)("span",{className:"text-destructive ml-1","aria-label":"required",children:"*"})]}),(0,b.jsx)("input",{id:k,"aria-invalid":e?"true":"false","aria-describedby":n,"aria-required":i.required?"true":void 0,className:(0,d.cn)("w-full px-4 py-2.5 rounded-lg border border-input bg-background text-foreground","placeholder:text-muted-foreground","focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent focus-visible:ring-2 focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",e&&"border-destructive focus:ring-destructive focus-visible:ring-destructive",g),...i}),e&&(0,b.jsx)("p",{id:l,className:"mt-1 text-sm text-destructive",role:"alert","aria-live":"assertive",children:e}),f&&!e&&(0,b.jsx)("p",{id:m,className:"mt-1 text-sm text-muted-foreground",children:f})]})}a.s(["default",()=>e])},10852,a=>{"use strict";let b=(0,a.i(31261).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],10852)},64888,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(21900),f=a.i(10852),g=a.i(47802),h=a.i(69355),i=a.i(59843),j=a.i(70579),k=a.i(18521),l=a.i(1892),m=a.i(35971),n=a.i(72084),o=a.i(39236),p=a.i(60328),q=a.i(92522),r=a.i(18188);a.i(59888);var s=a.i(98534);let t=p.productSchema.pick({title:!0,description:!0,price:!0,category:!0,condition:!0,location:!0,isNegotiable:!0});function u(){let a=(0,d.useRouter)(),p=(0,d.useParams)(),{user:u}=(0,m.useAuth)(),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(""),{register:H,handleSubmit:I,formState:{errors:J,isSubmitting:K},setError:L,setValue:M,reset:N,watch:O}=(0,k.useForm)({resolver:(0,l.zodResolver)(t),mode:"onBlur",defaultValues:{condition:"good",location:u?.location||"",isNegotiable:!1}}),P=O("isNegotiable");(0,c.useEffect)(()=>{let a=async()=>{try{let a=await o.categoriesAPI.getCategories();y(a.data.categories);let b=(await n.productsAPI.getProduct(p.id)).data.product;if(b.seller?._id!==u?._id&&u?.role!=="admin"){G("You are not authorized to edit this product"),A(!1);return}w(b),E(b.images||[]),N({title:b.title||"",description:b.description||"",price:b.price?.toString()||"",category:b.category?._id||"",condition:b.condition||"good",location:b.location||"",isNegotiable:b.isNegotiable||!1})}catch(a){console.error("Failed to fetch data:",a),G(a.response?.data?.message||"Failed to load product")}finally{A(!1)}};u&&a()},[p.id,u,N]);let Q=(0,c.useCallback)(async a=>{let b=a.target.files;if(!b||0===b.length)return;if(D.length+b.length>5)return void s.toast.error("You can only upload up to 5 images");C(!0);let c=[];for(let a=0;a<b.length;a++){let d=b[a],e=new FormData;e.append("image",d);try{let a=await fetch("http://localhost:5000/api/v1/upload/image",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:e}),b=await a.json();b.success&&c.push(b.data.url)}catch(b){console.error("Failed to upload image:",b);let a=URL.createObjectURL(d);c.push(a)}}E([...D,...c]),C(!1)},[D]),R=(0,c.useCallback)(a=>{E(D.filter((b,c)=>c!==a))},[D]),S=(0,c.useCallback)(async b=>{if(0===D.length)return void L("root",{type:"manual",message:"At least one image is required"});if(D.length>5)return void L("root",{type:"manual",message:"Maximum 5 images allowed"});try{let c=new FormData;c.append("title",b.title),c.append("description",b.description),c.append("price",b.price),c.append("category",b.category),c.append("condition",b.condition),c.append("location",b.location),c.append("isNegotiable",b.isNegotiable.toString()),D.forEach(a=>c.append("images",a)),await n.productsAPI.updateProduct(p.id,c),s.toast.success("Product updated successfully!"),a.push(`/products/${p.id}`)}catch(b){console.error("Failed to update product:",b),s.toast.error("Failed to update product.");let a=b.response?.data?.message||"Failed to update product";G(a),L("root",{type:"manual",message:a})}},[D,p.id,a,L]);return z?(0,b.jsx)("div",{className:"container mx-auto px-4 py-16",children:(0,b.jsxs)("div",{className:"max-w-3xl mx-auto text-center",children:[(0,b.jsx)(h.Loader2,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading product..."})]})}):F&&!v?(0,b.jsx)("div",{className:"container mx-auto px-4 py-16",children:(0,b.jsxs)("div",{className:"max-w-3xl mx-auto text-center",children:[(0,b.jsx)("div",{className:"p-4 rounded-lg bg-destructive/10 text-destructive mb-6",children:F}),(0,b.jsx)(i.default,{href:"/seller/products",children:(0,b.jsx)(q.default,{children:"Back to Products"})})]})}):(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-3xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)(i.default,{href:`/products/${p.id}`,className:"inline-flex items-center space-x-2 text-muted-foreground hover:text-foreground mb-4",children:[(0,b.jsx)(e.ArrowLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Back to Product"})]}),(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Product"})]}),F&&(0,b.jsx)("div",{className:"mb-6 p-4 rounded-lg bg-destructive/10 text-destructive",children:F}),(0,b.jsxs)("form",{onSubmit:I(S),className:"space-y-6",noValidate:!0,children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Product Images"}),(0,b.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[(0,b.jsx)("input",{type:"file",id:"images",multiple:!0,accept:"image/*",onChange:Q,className:"hidden",disabled:B||D.length>=5}),(0,b.jsxs)("label",{htmlFor:"images",className:"cursor-pointer",children:[(0,b.jsx)(f.Upload,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:B?"Uploading...":"Click to upload images (max 5)"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG up to 5MB each"})]})]}),D.length>0&&(0,b.jsx)("div",{className:"grid grid-cols-5 gap-4 mt-4",children:D.map((a,c)=>(0,b.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden border",children:[(0,b.jsx)(j.default,{src:a,alt:`Upload ${c+1}`,fill:!0,className:"object-cover",sizes:"100px"}),(0,b.jsx)("button",{type:"button",onClick:()=>R(c),className:"absolute top-1 right-1 p-1 bg-destructive text-destructive-foreground rounded-full opacity-0 hover:opacity-100 transition-opacity",children:(0,b.jsx)(g.X,{className:"h-4 w-4"})})]},c))})]}),(0,b.jsx)(r.default,{label:"Title",type:"text",placeholder:"e.g., iPhone 13 Pro - Excellent Condition",error:J.title?.message,...H("title")}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description"}),(0,b.jsx)("textarea",{...H("description"),placeholder:"Describe your product in detail...",rows:5,className:`w-full px-4 py-3 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-ring resize-none ${J.description?"border-destructive focus:ring-destructive":"border-input"}`}),J.description&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:J.description.message})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)("div",{children:(0,b.jsx)(r.default,{label:"Price (KES)",type:"number",placeholder:"5000",error:J.price?.message,...H("price")})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Category"}),(0,b.jsxs)("select",{...H("category"),className:`w-full px-4 py-3 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-ring ${J.category?"border-destructive focus:ring-destructive":"border-input"}`,children:[(0,b.jsx)("option",{value:"",children:"Select a category"}),x.map(a=>(0,b.jsx)("option",{value:a._id,children:a.name},a._id))]}),J.category&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:J.category.message})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Condition"}),(0,b.jsxs)("select",{...H("condition"),className:"w-full px-4 py-3 rounded-lg border border-input bg-background focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,b.jsx)("option",{value:"new",children:"New"}),(0,b.jsx)("option",{value:"like-new",children:"Like New"}),(0,b.jsx)("option",{value:"good",children:"Good"}),(0,b.jsx)("option",{value:"fair",children:"Fair"})]}),J.condition&&(0,b.jsx)("p",{className:"mt-1 text-sm text-destructive",children:J.condition.message})]}),(0,b.jsx)(r.default,{label:"Location",type:"text",placeholder:"e.g., Main Campus, Hostel A",error:J.location?.message,...H("location")})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"negotiable",...H("isNegotiable"),checked:P,onChange:a=>M("isNegotiable",a.target.checked),className:"w-4 h-4 rounded border-input"}),(0,b.jsx)("label",{htmlFor:"negotiable",className:"text-sm font-medium",children:"Price is negotiable"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 pt-4",children:[(0,b.jsx)(q.default,{type:"submit",size:"lg",isLoading:K,children:"Save Changes"}),(0,b.jsx)(i.default,{href:`/products/${p.id}`,children:(0,b.jsx)(q.default,{type:"button",variant:"outline",size:"lg",children:"Cancel"})})]})]})]})}a.s(["default",()=>u])}];

//# sourceMappingURL=frontend_0d8bfee0._.js.map